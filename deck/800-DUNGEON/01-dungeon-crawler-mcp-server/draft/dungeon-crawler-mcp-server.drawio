<mxfile host="65bd71144e">
    <diagram name="Dungeon MCP Server Architecture" id="dungeon-mcp-architecture">
        <mxGraphModel dx="499" dy="449" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1200" pageHeight="800" math="0" shadow="0">
            <root>
                <mxCell id="0"/>
                <mxCell id="1" parent="0"/>
                <mxCell id="main-container" value="main() Function" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontSize=14;fontStyle=1;arcSize=3;" parent="1" vertex="1">
                    <mxGeometry x="40" y="40" width="1120" height="720" as="geometry"/>
                </mxCell>
                <mxCell id="mcp-server" value="MCP Server Creation&#xa;NewMCPServer(&#xa;&quot;dungeon-mcp-server&quot;,&#xa;&quot;0.0.0&quot;)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=12;" parent="1" vertex="1">
                    <mxGeometry x="80" y="100" width="200" height="80" as="geometry"/>
                </mxCell>
                <mxCell id="agent-setup" value="Dungeon Agent Setup" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=12;fontStyle=1;" parent="1" vertex="1">
                    <mxGeometry x="320" y="80" width="200" height="40" as="geometry"/>
                </mxCell>
                <mxCell id="openai-client" value="OpenAI Client&#xa;Base URL: MODEL_RUNNER_BASE_URL&#xa;Model: DUNGEON_MODEL" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=10;" parent="1" vertex="1">
                    <mxGeometry x="320" y="140" width="200" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="micro-agent" value="Micro Agent (mu.NewAgent)&#xa;- dungeon-agent&#xa;- JSON Schema Response&#xa;- Temperature Control" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=10;" parent="1" vertex="1">
                    <mxGeometry x="320" y="220" width="200" height="80" as="geometry"/>
                </mxCell>
                <mxCell id="game-init" value="Game Initialization" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;fontSize=12;fontStyle=1;" parent="1" vertex="1">
                    <mxGeometry x="560" y="80" width="200" height="40" as="geometry"/>
                </mxCell>
                <mxCell id="player" value="Player&#xa;Name: &quot;Unknown&quot;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;fontSize=10;" parent="1" vertex="1">
                    <mxGeometry x="560" y="140" width="90" height="50" as="geometry"/>
                </mxCell>
                <mxCell id="dungeon" value="Dungeon&#xa;- Name, Description&#xa;- Width x Height&#xa;- Entrance/Exit Coords&#xa;- Rooms[]" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;fontSize=10;" parent="1" vertex="1">
                    <mxGeometry x="670" y="140" width="120" height="80" as="geometry"/>
                </mxCell>
                <mxCell id="entrance-gen" value="Entrance Room Generation" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=12;fontStyle=1;" parent="1" vertex="1">
                    <mxGeometry x="320" y="340" width="200" height="40" as="geometry"/>
                </mxCell>
                <mxCell id="agent-room-gen" value="dungeonAgent.Run()&#xa;System: DUNGEON_AGENT_ROOM_SYSTEM_INSTRUCTION&#xa;User: &quot;Create entrance room&quot;&#xa;Response: JSON {name, description}" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=10;" parent="1" vertex="1">
                    <mxGeometry x="320" y="400" width="200" height="100" as="geometry"/>
                </mxCell>
                <mxCell id="room-creation" value="Entrance Room Creation&#xa;- ID: &quot;room_0_0&quot;&#xa;- Generated Name/Description&#xa;- IsEntrance: true&#xa;- Coordinates, Flags" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=10;" parent="1" vertex="1">
                    <mxGeometry x="560" y="400" width="180" height="100" as="geometry"/>
                </mxCell>
                <mxCell id="tools-section" value="MCP Tools Registration" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e6ccff;strokeColor=#9673a6;fontSize=12;fontStyle=1;" parent="1" vertex="1">
                    <mxGeometry x="80" y="540" width="1040" height="40" as="geometry"/>
                </mxCell>
                <mxCell id="tool1" value="CreatePlayer" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e6ccff;strokeColor=#9673a6;fontSize=10;" parent="1" vertex="1">
                    <mxGeometry x="80" y="600" width="90" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="tool2" value="GetPlayerInfo" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e6ccff;strokeColor=#9673a6;fontSize=10;" parent="1" vertex="1">
                    <mxGeometry x="190" y="600" width="90" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="tool3" value="GetDungeonInfo" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e6ccff;strokeColor=#9673a6;fontSize=10;" parent="1" vertex="1">
                    <mxGeometry x="300" y="600" width="90" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="tool4" value="MovePlayer" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e6ccff;strokeColor=#9673a6;fontSize=10;" parent="1" vertex="1">
                    <mxGeometry x="410" y="600" width="90" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="tool5" value="GetCurrentRoom" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e6ccff;strokeColor=#9673a6;fontSize=10;" parent="1" vertex="1">
                    <mxGeometry x="520" y="600" width="90" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="tool6" value="GetDungeonMap" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e6ccff;strokeColor=#9673a6;fontSize=10;" parent="1" vertex="1">
                    <mxGeometry x="630" y="600" width="90" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="tool7" value="CollectGold" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e6ccff;strokeColor=#9673a6;fontSize=10;" parent="1" vertex="1">
                    <mxGeometry x="740" y="600" width="90" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="tool8" value="CollectPotion" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e6ccff;strokeColor=#9673a6;fontSize=10;" parent="1" vertex="1">
                    <mxGeometry x="850" y="600" width="90" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="tool9" value="FightMonster" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e6ccff;strokeColor=#9673a6;fontSize=10;" parent="1" vertex="1">
                    <mxGeometry x="960" y="600" width="90" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="tool10" value="IsPlayerInSameRoomAsNPC" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e6ccff;strokeColor=#9673a6;fontSize=10;" parent="1" vertex="1">
                    <mxGeometry x="80" y="650" width="160" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="http-server" value="HTTP Server Setup" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;fontSize=12;fontStyle=1;" parent="1" vertex="1">
                    <mxGeometry x="800" y="80" width="280" height="40" as="geometry"/>
                </mxCell>
                <mxCell id="mux" value="HTTP ServeMux&#xa;- /health → healthCheckHandler&#xa;- /mcp → MCP Server" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;fontSize=10;" parent="1" vertex="1">
                    <mxGeometry x="800" y="140" width="180" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="server-start" value="http.ListenAndServe&#xa;Port: MCP_HTTP_PORT (9090)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;fontSize=10;" parent="1" vertex="1">
                    <mxGeometry x="800" y="220" width="180" height="50" as="geometry"/>
                </mxCell>
                <mxCell id="arrow1" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="agent-setup" target="openai-client" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="arrow2" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="openai-client" target="micro-agent" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="arrow3" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="game-init" target="player" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="arrow4" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="game-init" target="dungeon" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="arrow5" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="micro-agent" target="entrance-gen" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="arrow6" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="entrance-gen" target="agent-room-gen" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="arrow7" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="agent-room-gen" target="room-creation" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="arrow8" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="http-server" target="mux" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="arrow9" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="mux" target="server-start" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
            </root>
        </mxGraphModel>
    </diagram>
</mxfile>